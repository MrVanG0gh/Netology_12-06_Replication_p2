# Домашнее задание к занятию "Репликация и масштабирование. Часть 2" - `Иншаков Владимир`

---

## Задание 1
Опишите основные преимущества использования масштабирования методами:

- активный master-сервер и пассивный репликационный slave-сервер;
- master-сервер и несколько slave-серверов;
Дайте ответ в свободной форме.

## Решение 1

Для связки Master-slave можно отметить следующее:

- Простота реализации. Легкость настройки и поддержания работы;
- Отказоустойчивость. При сбое в работе Master`а slave сможет его заменить;
- Резервное копирование. Slave реплику удобно использовать для резервного копирования, не загружая при этом Master`а;
- Балансировка. Часть запросов на чтение можно осуществлять при помощи slave-сервера;

В случае, если имеется несколько slave-серверов:

- Увеличение производительности. Горизонтальное масштабирование позволит значительно увеличить производительность БД при работе с запросами на чтение;
- Отказоустойчивость. Сбой в работе одного из slave-серверов не повлияет на доступность остальных. При отказе Master-сервера, его роль сможет продолжить один из slave;
- Резервное копирование. Одна из slave-реплик может быть использована для резервного копирования, не загружая при этом остальные серверы;
- Балансировка. Как и в случае с одним slave-сервером, мы можем задействовать несколько slave-серверов и разгрузить master`а, а также сбалансировать нагрузку между ними;
- Геораспределение. Можно увеличить быстродействие работы системы, если расположить отдельные slave-сервера ближе к конечным пользователям (так мы сможем уменьшить задержки при передаче данных);

---

## Задание 2
Разработайте план для выполнения горизонтального и вертикального шардинга базы данных. База данных состоит из трёх таблиц:

- пользователи,
- книги,
- магазины (столбцы произвольно).

Опишите принципы построения системы и их разграничение или разбивку между базами данных.

Пришлите блок-схему, где и что будет располагаться. Опишите, в каких режимах будут работать сервера.

## Решение 2

Добавим чуть больше фактов о нашей гипотетической БД. Предположим, что в таблице "Пользователи" у нас есть столбцы:

- id
- Фамилия
- Имя
- Номер телефона
- Адрес

Таблица "Книги" содержит следующие столбцы:

- id
- Автор
- Название
- Год
- Аннотация

Таблица "Магазины" содержит:

- id
- адрес

### Вертикальный шардинг

Предположим, что мы хотим разбить нашу БД на несколько шард из-за того, что часть информации (например, фамилия, имя и телефон) запрашивается чаще других.
Поэтому разобьем таблицу "Пользователи" на две:

![Screen_1](https://github.com/MrVanG0gh/Netology_12-07_Replication_p2/blob/main/Screenshots/Screenshot_1.png)

И таблицу "Книги" тоже разобьем на две части:

![Screen_2](https://github.com/MrVanG0gh/Netology_12-07_Replication_p2/blob/main/Screenshots/Screenshot_2.png)

Теперь разместим наши шарды на разных серверах:

Server_1 будет хранить шарды:

- "Пользователи_VS1"
- "Книги_VS1"

![Screen_3](https://github.com/MrVanG0gh/Netology_12-07_Replication_p2/blob/main/Screenshots/Screenshot_3.png)

Server_2 будет хранить шарды:

- "Пользователи_VS2"
- "Книги_VS2"

![Screen_4](https://github.com/MrVanG0gh/Netology_12-07_Replication_p2/blob/main/Screenshots/Screenshot_4.png)

Server_3:

- "Магазины"

![Screen_5](https://github.com/MrVanG0gh/Netology_12-07_Replication_p2/blob/main/Screenshots/Screenshot_5.png)

Таким образом, при помощи шардинга удалось разнести по различным серверам столбцы таблиц по частоте обращений к БД.

### Горизонтальный шардинг

Предположим, что теперь мы хотим равномерно распределить данные по нескольким серверам. Тогда разделение таблиц "Пользователи" и "Книги" будет произведено в соответствии со значениями столбца ID:

Значения с 1 по 1 000 000 будут храниться на Server_1. Значения с 1 000 001 по 2 000 000 - на Server_2.

![Screen_6](https://github.com/MrVanG0gh/Netology_12-07_Replication_p2/blob/main/Screenshots/Screenshot_6.png)

![Screen_7](https://github.com/MrVanG0gh/Netology_12-07_Replication_p2/blob/main/Screenshots/Screenshot_7.png)

Теперь разместим наши шарды на разных серверах:

Server_1 будет хранить шарды:

- "Пользователи_HS1"
- "Книги_HS1"

![Screen_8](https://github.com/MrVanG0gh/Netology_12-07_Replication_p2/blob/main/Screenshots/Screenshot_8.png)

Server_1 будет хранить шарды:

- "Пользователи_HS2"
- "Книги_HS2"

![Screen_9](https://github.com/MrVanG0gh/Netology_12-07_Replication_p2/blob/main/Screenshots/Screenshot_9.png)


Server_3:

- "Магазины"

![Screen_10](https://github.com/MrVanG0gh/Netology_12-07_Replication_p2/blob/main/Screenshots/Screenshot_10.png)

Таким образом, при помощи шардинга удалось равномерно распределить объемные таблицы по различным серверам.

---